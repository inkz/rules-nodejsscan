rules:
  - id: node_deserialize
    patterns:
      - pattern-either:
          - pattern-inside: |
              var $PKG =  require('serialize-to-js');
              ...
              $PKG.deserialize(...);
          - pattern: |
              var $PKG =  require('node-serialize');
              ...
              $PKG.unserialize(...);
          - pattern: |
              require('node-serialize').unserialize(...);
          - pattern: |
              require('serialize-to-js').deserialize(...);
    message: >-
      User controlled data in 'unserialize()' or 'deserialize()' function can
      result in Object Injection or Remote Code Injection.
    languages:
      - javascript
    severity: ERROR
    metadata:
      owasp: 'A8: Insecure Deserialization'
      cwe: 'CWE-502: Deserialization of Untrusted Data'
